# C

## 数据类型

### 基本数据类型

- `char`：1字节，字符型
- `int`：4字节，整型  
- `float`：4字节，单精度浮点型
- `double`：8字节，双精度浮点型
- `void`：无类型

### 派生数据类型

- 数组
- 指针
- 结构体
- 共用体
- 枚举

## 运算符

### 位运算（重点）

- `&` 按位与：全1为1，否则为0
- `|` 按位或：有1为1，全0为0  
- `^` 按位异或：相同为0，不同为1
- `~` 按位取反：0变1，1变0
- `<<` 左移：高位丢弃，低位补0
- `>>` 右移：低位丢弃，高位补符号位

### 其他运算符

- 算术运算符：`+ - * / %`
- 关系运算符：`> < >= <= == !=`
- 逻辑运算符：`&& || !`
- 赋值运算符：`= += -= *= /=`

## 输入输出

### 标准输入输出函数

```c
printf("格式字符串", 变量列表); # 格式化输入相关
scanf("格式字符串", 地址列表); # 格式化输出相关 接收多余按键相关
```

## 控制结构

### if语句

### switch语句

## 循环结构

### for循环

### while循环

### do...while循环

### goto语句（嵌入式常用）

````c
label: 
    语句1;
    语句2;
    ...
    if(条件)
        goto label; // 跳转到label处继续执行
````

## 循环辅助语句

### break语句

- 用于跳出当前循环（for、while、do...while）
- 可以在嵌套循环中使用，跳出最近的循环

### continue语句

- 用于跳过当前循环的剩余语句，直接进入下一次循环
- 可以在嵌套循环中使用，跳过最近的循环

## 数组

### 一维数组

### 二维数组

### 字符数组

#### 字符串

- 以空字符`\0`结尾的字符数组
- 双引号括起

## 指针

### 指针变量

#### 数据类型 *指针变量名

- 存储变量地址的变量
- 指针变量的类型决定了解引用时的数据类型

### 指针运算

- *p:取指针指向的值
- &a:取变量的地址
- p++:指针加1，指向下一个同类型变量
- p--:指针减1，指向上一个同类型变量

### 指针和数组

#### 和一维数组

````c
int arr[5] = {1,2,3,4,5};
int *p = arr; // p指向数组首元素
````

#### 和二维数组

````c
int arr[2][3] = {{1,2,3},{4,5,6}};
int (*p)[3] = arr; // p指向二维数组首行，是数组指针
````

### 字符指针和字符串

```c
char *str = "hello"; // str指向字符串常量"hello"，不可修改
char arr[] = "world"; // arr是字符数组，存储在栈区，可修改
char *p = arr;
````

### 数组指针

```c
int (*p)[n]; // 指向含有n个元素的数组的指针 指向数组首元素
````

### 指针数组

```c
int *arr[n]; // 每个元素都是指针的数组
````

### 函数指针

```c
//返回值类型 (*指针变量名)(参数列表);
int (*func_ptr)(int, int);// 指向代码区的函数首地址（常量地址）
````

### 多级指针

````c
int a = 10;
int *p = &a;
int **pp = &p; // 二级指针，指向一级指针的地址
````

### void指针

- 无具体数据类型的指针
- 可以指向任意类型的变量
- 不能直接进行解引用操作，需要先转换为其他类型的指针
- 可以用于函数参数传递，实现通用的函数调用

## 函数

### 函数参数传递

- 值传递：将实参的值复制给形参，函数内修改形参不影响实参
- 引用传递（指针传递）：将实参的地址传递给形参，函数内通过指针操作实参，影响实参的值

### 函数声明

- 函数声明：在函数调用之前声明函数的返回类型、函数名和参数类型

### 字符串处理函数

- `strlen`：计算字符串长度
- `strcpy`：复制字符串
- `strcat`：连接字符串
- `strcmp`：比较字符串
- `strchr`：查找字符在字符串中的位置
- `strstr`：查找子字符串在字符串中的位置
- ...

## 变量作用域和生命周期

### 变量作用域

- 局部变量：在函数或代码块内定义，只能在其作用域内访问
- 全局变量：在函数外部定义，整个程序都可以访问
- 静态变量：使用`static`关键字定义，局部静态变量在函数调用结束后仍然存在，全局静态变量只能在定义它的文件内访问
- 块作用域变量：在代码块（如循环或分支语句）的‘{}’内定义，只能在其作用域内访问

### 变量生命周期

- 自动变量：函数调用时创建，结束时销毁，存储在栈区
- 静态变量：程序运行期间一直存在，存储在静态数据区
- 全局变量：在程序开始时创建，程序结束时销毁，存储在静态数据区
- 动态分配的变量：手动分配和释放，存储在堆区

## 内存分区及内存管理

### 内存分区

- 栈区：存储函数调用时的局部变量、参数、返回地址等，由系统自动分配和释放
- 堆区：动态分配的内存，手动分配和释放，由程序员管理
- 数据区：存储全局变量、静态变量等，在程序开始时分配，程序结束时释放
- 代码区：存储函数的二进制代码，只读，由系统管理

### 动态内存分配

````c
#include <stdlib.h>

void *malloc(size_t size);     // 分配内存
void *calloc(size_t n, size_t size); // 分配并清零
void *realloc(void *ptr, size_t size); // 重新分配
void free(void *ptr);          // 释放内存
````

## typedef、const、static以及extern

### typedef

- 用于为已有的数据类型定义新的名称，简化复杂的类型声明，提高代码可读性

### const

- 用于定义常量，其值在程序运行期间不能被修改
- 可以用于函数参数、返回值、全局变量等

### static

- 用于定义静态变量，其值在程序运行期间一直存在
- 可以用于函数内部的局部变量，限制其作用域在当前函数内
- 可以用于全局变量，限制其作用域在当前文件内

### extern

- 用于声明外部变量，即全局变量
- 可以在不同的源文件中使用，实现跨文件共享变量

## 预处理指令

- 宏定义：使用`#define`指令定义宏，用于代码替换和常量定义（只是文字替换）
- 条件编译：使用`#if`、`#ifdef`、`#ifndef`、`#else`、`#endif`等指令根据条件编译不同的代码
- 文件包含：使用`#include`指令包含其他源文件的代码
- 其他指令：如`#pragma once`、`#line`等

## 结构体

### 结构体定义

- 用于存储不同类型的变量
- 结构体定义使用`struct`关键字，后面跟着结构体名和成员变量
- 排序尽量按照数据类型的大小排序
- 结构体成员访问
  - 点运算符：`struct_name.member_name`
  - 箭头运算符：`ptr->member_name`
- 结构体的初始化
  - 按顺序初始化：`struct_name member_name = {value1, value2, ...}`
  - 按成员名初始化：`struct_name member_name = {.member1 = value1, .member2 = value2, ...}`

### 结构体数组

- 定义方式：`struct_name array_name[array_size];`
- 访问方式：`array_name[index].member_name` 或 `ptr->member_name`

### 结构体指针

- 定义方式：`struct_name *ptr;`
- 访问方式：`ptr->member_name` 或 `(*ptr).member_name`

### 结构体大小及对齐规则

- 结构体的大小等于其成员变量中最大数据类型的大小的整数倍
- 结构体成员的对齐规则：
  - 第一个成员的地址与结构体的地址相同
  - 每个成员的地址必须是其数据类型大小的整数倍
  - 结构体的总大小必须是其成员中最大数据类型大小的整数倍
- 结构体的对齐规则可以通过`#pragma pack(n)`指令来指定，n为对齐字节数，默认值为编译器的默认对齐字节数
- 位域：结构体成员可以占用小于其数据类型大小的内存空间，用于节省内存
  - struct packed_struct {
          int a : 2;
          int b : 3;
          int c : 3;
         };

## 共用体

### 共用体定义

- 用于存储不同类型的变量，但是在任意时刻只能存储其中的一个成员
- 共用体定义使用`union`关键字，后面跟着共用体名和成员变量
- 排序尽量按照数据类型的大小排序
- 共用体成员访问
  - 点运算符：`union_name.member_name`
  - 箭头运算符：`ptr->member_name`
- 共用体的大小等于其成员变量中最大数据类型的大小，不能多次存储不同类型的变量

## 枚举

### 枚举定义

- 用于状态机状态定义、错误码定义、选项标志位

````c
enum 枚举名 {
    标识符1 = 值1,
    标识符2 = 值2,
    // ...
};
````

## GDB调试

````bash
gcc -g program.c -o program
gdb program

# GDB命令
break 行号/函数名    # 设置断点
run                 # 运行程序
next                # 单步执行
step                # 进入函数
print 变量名         # 查看变量值
backtrace           # 查看调用栈
quit                # 退出
````

### 分文件编程

- 头文件（.h）：声明函数、结构体、宏定义等
- 源文件（.c）：实现函数、定义变量等
- 主文件（main.c）：包含头文件，调用函数等
- 编译链接
